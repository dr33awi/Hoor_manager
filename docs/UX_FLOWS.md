# 🎯 UX Flows Documentation

## المبدأ الأساسي: 3-Tap Rule

> أي عملية يومية يجب أن تتم في 3 نقرات أو أقل

---

## 📊 Flow 1: إنشاء فاتورة بيع سريعة

### المسار السعيد (Happy Path)

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                                                                             │
│    Dashboard                                                                │
│        │                                                                    │
│        ▼ [نقرة 1: زر "+" أو "فاتورة بيع"]                                  │
│                                                                             │
│    Invoice Form                                                             │
│        │                                                                    │
│        ▼ [نقرة 2: مسح باركود أو اختيار منتج]                               │
│                                                                             │
│    Add Items (اختياري: تكرار لإضافة منتجات)                                 │
│        │                                                                    │
│        ▼ [نقرة 3: زر "حفظ وطباعة"]                                         │
│                                                                             │
│    ✅ Success + Print                                                       │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

### States & Feedback

| الحالة | الفعل | التغذية الراجعة |
|--------|-------|-----------------|
| Loading | جاري حفظ الفاتورة | Progress indicator |
| Success | تم الحفظ | ✓ Animation + طباعة تلقائية |
| Error | فشل الحفظ | Shake + رسالة خطأ واضحة |
| Warning | منتج نفذ | تنبيه برتقالي + إمكانية المتابعة |

---

## 💰 Flow 2: تحصيل سند قبض

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                                                                             │
│    Dashboard → Quick Action "سند قبض"                                       │
│        │                                                                    │
│        ▼ [نقرة 1]                                                          │
│                                                                             │
│    ┌─────────────────────────────┐                                          │
│    │  اختر العميل               │                                          │
│    │  [بحث أو اختيار من القائمة] │                                          │
│    └─────────────────────────────┘                                          │
│        │                                                                    │
│        ▼ [نقرة 2: اختيار العميل]                                           │
│                                                                             │
│    ┌─────────────────────────────┐                                          │
│    │  رصيد العميل: 5,000 ر.س    │                                          │
│    │  المبلغ: [________]        │                                          │
│    │  ملاحظات: [________]       │                                          │
│    │  [● نقداً] [○ تحويل]       │                                          │
│    └─────────────────────────────┘                                          │
│        │                                                                    │
│        ▼ [نقرة 3: حفظ]                                                     │
│                                                                             │
│    ✅ Success                                                               │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 📦 Flow 3: إضافة منتج جديد

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                                                                             │
│    Products Screen → [+]                                                    │
│        │                                                                    │
│        ▼                                                                    │
│                                                                             │
│    ┌─────────────────────────────────────────────────────────────┐          │
│    │                    منتج جديد                                 │          │
│    │                                                              │          │
│    │  📷 [إضافة صورة]                                            │          │
│    │                                                              │          │
│    │  الاسم *          [________________]                         │          │
│    │  الباركود         [________] [📷 مسح]                        │          │
│    │  التصنيف          [اختر التصنيف ▼]                          │          │
│    │                                                              │          │
│    │  ─────────────────────────────────────────                  │          │
│    │                                                              │          │
│    │  سعر الشراء *     [________] ر.س                            │          │
│    │  سعر البيع *      [________] ر.س                            │          │
│    │  هامش الربح       15%                                       │          │
│    │                                                              │          │
│    │  ─────────────────────────────────────────                  │          │
│    │                                                              │          │
│    │  الكمية الافتتاحية [________]                               │          │
│    │  الحد الأدنى       [________]                               │          │
│    │  المستودع          [الرئيسي ▼]                              │          │
│    │                                                              │          │
│    │           [إلغاء]  [حفظ وإضافة آخر]  [حفظ]                  │          │
│    └─────────────────────────────────────────────────────────────┘          │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

### الحقول الذكية

- **الباركود**: مسح تلقائي عند التركيز + إنشاء تلقائي إذا فارغ
- **هامش الربح**: حساب تلقائي من سعر الشراء والبيع
- **التصنيف**: اقتراحات ذكية بناءً على الاسم

---

## ⏰ Flow 4: إدارة الوردية

### بدء الوردية

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                                                                             │
│    Dashboard (لا توجد وردية مفتوحة)                                         │
│        │                                                                    │
│        ▼ [نقر على البانر]                                                  │
│                                                                             │
│    ┌─────────────────────────────────────────────────────────────┐          │
│    │                    بدء وردية جديدة                          │          │
│    │                                                              │          │
│    │  📅 التاريخ: 2026/01/01                                     │          │
│    │  ⏰ الوقت: 9:00 ص                                          │          │
│    │                                                              │          │
│    │  ─────────────────────────────────────────                  │          │
│    │                                                              │          │
│    │  💵 النقدية الافتتاحية                                      │          │
│    │     [___________] ر.س                                       │          │
│    │                                                              │          │
│    │  📝 ملاحظات (اختياري)                                       │          │
│    │     [_________________________]                              │          │
│    │                                                              │          │
│    │              [إلغاء]  [بدء الوردية ▶]                       │          │
│    └─────────────────────────────────────────────────────────────┘          │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

### إنهاء الوردية

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                                                                             │
│    Shift Details → [إنهاء الوردية]                                         │
│        │                                                                    │
│        ▼                                                                    │
│                                                                             │
│    ┌─────────────────────────────────────────────────────────────┐          │
│    │                    إنهاء الوردية                            │          │
│    │                                                              │          │
│    │  ═══════════════════════════════════════════                │          │
│    │                   ملخص الوردية                              │          │
│    │  ═══════════════════════════════════════════                │          │
│    │                                                              │          │
│    │  المدة: 8 ساعات و 30 دقيقة                                  │          │
│    │                                                              │          │
│    │  ─────────────────────────────────────────                  │          │
│    │  النقدية الافتتاحية         1,000.00 ر.س                    │          │
│    │  + المبيعات النقدية        15,750.00 ر.س                    │          │
│    │  + سندات القبض              2,500.00 ر.س                    │          │
│    │  - سندات الصرف             -1,200.00 ر.س                    │          │
│    │  - المشتريات النقدية       -3,000.00 ر.س                    │          │
│    │  ─────────────────────────────────────────                  │          │
│    │  المتوقع في الصندوق        15,050.00 ر.س                    │          │
│    │                                                              │          │
│    │  ═══════════════════════════════════════════                │          │
│    │                                                              │          │
│    │  💵 العد الفعلي للنقدية                                     │          │
│    │     [___________] ر.س                                       │          │
│    │                                                              │          │
│    │  ⚠️ الفرق: 0.00 ر.س                                        │          │
│    │                                                              │          │
│    │       [إلغاء]  [حفظ وطباعة التقرير]  [حفظ]                  │          │
│    └─────────────────────────────────────────────────────────────┘          │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 🔍 Flow 5: البحث والتصفية

### البحث العام

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                                                                             │
│  ┌────────────────────────────────────────────────────────────────────┐     │
│  │ 🔍 ابحث عن فاتورة، عميل، منتج...                                   │     │
│  └────────────────────────────────────────────────────────────────────┘     │
│        │                                                                    │
│        ▼ [الكتابة]                                                         │
│                                                                             │
│  ┌────────────────────────────────────────────────────────────────────┐     │
│  │  💡 نتائج سريعة                                                    │     │
│  ├────────────────────────────────────────────────────────────────────┤     │
│  │  📄 فاتورة #1234                              2:30 م اليوم        │     │
│  │     أحمد محمد | 1,500 ر.س                                          │     │
│  ├────────────────────────────────────────────────────────────────────┤     │
│  │  👤 أحمد محمد الأحمدي                                             │     │
│  │     عميل | رصيد: 3,500 ر.س                                        │     │
│  ├────────────────────────────────────────────────────────────────────┤     │
│  │  📦 منتج ABC - أحمر                                               │     │
│  │     150 ر.س | مخزون: 25                                           │     │
│  ├────────────────────────────────────────────────────────────────────┤     │
│  │                    [عرض كل النتائج (15)]                          │     │
│  └────────────────────────────────────────────────────────────────────┘     │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

### التصفية المتقدمة

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                                                                             │
│  Filters (Bottom Sheet)                                                     │
│                                                                             │
│  ┌────────────────────────────────────────────────────────────────────┐     │
│  │  ⎯⎯⎯⎯⎯⎯⎯⎯⎯                                                        │     │
│  │                         الفلاتر                                    │     │
│  │                                                                    │     │
│  │  الفترة الزمنية                                                   │     │
│  │  [ اليوم ] [ الأسبوع ] [ الشهر ] [ مخصص... ]                     │     │
│  │                                                                    │     │
│  │  الحالة                                                           │     │
│  │  [ ✓ الكل ] [ مدفوع ] [ معلق ] [ متأخر ]                         │     │
│  │                                                                    │     │
│  │  نوع الفاتورة                                                     │     │
│  │  [ ✓ مبيعات ] [ ✓ مشتريات ] [ مرتجعات ]                          │     │
│  │                                                                    │     │
│  │  العميل                                                           │     │
│  │  [اختر العميل ▼]                                                  │     │
│  │                                                                    │     │
│  │  نطاق المبلغ                                                      │     │
│  │  من [______] إلى [______] ر.س                                    │     │
│  │                                                                    │     │
│  │           [مسح الفلاتر]           [تطبيق]                         │     │
│  └────────────────────────────────────────────────────────────────────┘     │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 📊 Flow 6: عرض التقارير

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                                                                             │
│    Reports Dashboard                                                        │
│        │                                                                    │
│        ├──────────────────────────────────────────────────────────────┐     │
│        │                                                               │     │
│        ▼                               ▼                               ▼     │
│  ┌───────────────┐            ┌───────────────┐            ┌───────────────┐│
│  │ تقرير المبيعات│            │تقرير المخزون │            │الأرباح والخسائر││
│  │               │            │               │            │               ││
│  │  📊           │            │  📦           │            │  💰           ││
│  │               │            │               │            │               ││
│  │  45,000 ر.س   │            │  156 منتج    │            │  +12,500 ر.س  ││
│  │  هذا الشهر    │            │  12 تحذير    │            │  +15%         ││
│  └───────────────┘            └───────────────┘            └───────────────┘│
│                                                                             │
│        ▼ [اختيار تقرير]                                                    │
│                                                                             │
│    Report Details                                                           │
│        │                                                                    │
│        ├── Chart (رسم بياني تفاعلي)                                        │
│        ├── Summary Cards (ملخص سريع)                                       │
│        ├── Data Table (جدول تفصيلي)                                        │
│        └── Actions: [تصدير PDF] [تصدير Excel] [مشاركة]                     │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 🎨 Micro-interactions Specifications

### 1. Pull to Refresh

```dart
// Trigger distance: 80.h
// Animation: Custom Lottie animation
// Duration: 1500ms max
// Haptic: mediumImpact on trigger
```

### 2. Swipe Actions on List Items

```dart
// Direction: RTL (endToStart)
// Actions:
//   - Edit (Blue): 0-80px
//   - Delete (Red): 80-160px
//   - Archive (Orange): 160px+ (optional)
// Haptic: lightImpact on each threshold
```

### 3. Form Validation

```dart
// Real-time validation: 500ms debounce
// Error animation: shake (300ms, horizontal)
// Success animation: checkmark scale (200ms)
```

### 4. Number Input Counter

```dart
// Animation: CountUp
// Duration: 600ms
// Curve: easeOutExpo
// Update on: focus lost or explicit save
```

### 5. Card Press

```dart
// Scale: 0.98
// Duration: 150ms
// Curve: easeInOut
// Haptic: lightImpact
```

### 6. Modal/Sheet Transitions

```dart
// Entry: slideUp + fadeIn
// Exit: slideDown + fadeOut
// Duration: 300ms
// Curve: easeOutCubic
// Backdrop: 0.5 opacity black
```

---

## ♿ Accessibility Checklist

- [ ] Minimum touch target: 48x48dp
- [ ] Color contrast ratio: ≥ 4.5:1
- [ ] Screen reader labels for all interactive elements
- [ ] Focus indicators visible
- [ ] Reduced motion option respected
- [ ] Text scales with system settings
- [ ] Error messages announced to screen readers

---

*Last Updated: January 2026*
